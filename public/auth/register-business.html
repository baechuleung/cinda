<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>업소회원 가입</title>
    
    <!-- SEO 태그는 seo-manager.js가 동적으로 삽입 -->
    <script type="module" src="/js/seo-manager.js"></script>
    
    <link rel="stylesheet" href="/css/common.css">
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/auth/css/register-business.css">
</head>
<body>
    <!-- 헤더 -->
    <header>
        <nav>
            <button class="back-button">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 18L9 12L15 6" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
            <h1 class="page-title">업소회원 가입</h1>
        </nav>
    </header>

    <div class="register-container">
        <div class="register-form">
            <form id="registerForm">
                <!-- 이메일 -->
                <div class="form-group">
                    <label for="email">이메일 <span class="required">*</span></label>
                    <div class="input-with-dropdown">
                        <input type="text" id="emailId" placeholder="이메일 아이디" required>
                        <span class="at-symbol">@</span>
                        <div class="custom-dropdown email-domain-dropdown">
                            <div class="dropdown-selected" id="emailDropdownSelected">
                                <span class="selected-text">도메인 선택</span>
                                <svg class="dropdown-arrow" width="12" height="8" viewBox="0 0 12 8" fill="none">
                                    <path d="M1 1.5L6 6.5L11 1.5" stroke="#666" stroke-width="1.5" stroke-linecap="round"/>
                                </svg>
                            </div>
                            <div class="dropdown-menu" id="emailDropdownMenu" style="display: none;">
                                <div class="dropdown-options" id="emailDropdownOptions">
                                    <div class="dropdown-option" data-value="">도메인 선택</div>
                                    <div class="dropdown-option" data-value="naver.com">naver.com</div>
                                    <div class="dropdown-option" data-value="gmail.com">gmail.com</div>
                                    <div class="dropdown-option" data-value="daum.net">daum.net</div>
                                    <div class="dropdown-option" data-value="hanmail.net">hanmail.net</div>
                                    <div class="dropdown-option" data-value="nate.com">nate.com</div>
                                    <div class="dropdown-option" data-value="kakao.com">kakao.com</div>
                                </div>
                            </div>
                        </div>
                        <input type="hidden" id="email" name="email" required>
                    </div>
                </div>

                <!-- 비밀번호 -->
                <div class="form-group">
                    <label for="password">비밀번호</label>
                    <div class="password-input">
                        <input type="password" id="password" placeholder="영문, 숫자, 특수문자가 모두 들어간 8~20자" autocomplete="new-password" required>
                        <span class="show-password" onclick="togglePassword()">
                            <svg class="eye-icon" width="20" height="16" viewBox="0 0 20 16" fill="none">
                                <path d="M10 3C6.5 3 3.44 5.11 1.88 8C3.44 10.89 6.5 13 10 13C13.5 13 16.56 10.89 18.12 8C16.56 5.11 13.5 3 10 3Z" stroke="#999" stroke-width="1.5"/>
                                <circle cx="10" cy="8" r="2.5" stroke="#999" stroke-width="1.5"/>
                            </svg>
                            <svg class="eye-off-icon" style="display: none;" width="20" height="16" viewBox="0 0 20 16" fill="none">
                                <path d="M3 3L17 13M8.77778 5.5C8.24671 5.96643 7.91111 6.63998 7.91111 7.4C7.91111 8.95051 9.17503 10.2 10.7333 10.2C11.5087 10.2 12.1949 9.86873 12.6667 9.34444M10.6901 4.60496C13.8302 4.78239 16.4818 6.48177 18.3467 8.8C16.5378 11.0576 14.0162 12.6949 11.1067 12.9462M5.28889 5.34222C3.01333 6.53511 1.17333 8.3897 0 10.6C1.80889 12.9185 4.33067 14.6 7.22667 14.8" stroke="#999" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                        </span>
                    </div>
                </div>

                <!-- 비밀번호 확인 -->
                <div class="form-group">
                    <label for="confirmPassword">비밀번호 확인</label>
                    <input type="password" id="confirmPassword" placeholder="비밀번호 확인을 위해 한번 더 입력해 주세요" autocomplete="new-password" required>
                </div>

                <!-- 커뮤니티 전용 닉네임 -->
                <div class="form-group">
                    <label for="nickname">커뮤니티 전용 닉네임 <span class="required">*</span></label>
                    <input type="text" id="nickname" placeholder="커뮤니티에서 사용할 닉네임을 적어주세요" required>
                </div>

                <!-- 숨겨진 필드들 (DB 저장용) -->
                <input type="hidden" id="name" value="홍길동">
                <input type="hidden" id="birthdate" value="1999년 02월 12일">
                <input type="hidden" id="phone" value="010-1234-5678">

                <!-- 전체동의 -->
                <div class="section-title">
                    <input type="checkbox" id="allAgree" onclick="toggleAllCheckboxes()">
                    <label for="allAgree">전체동의</label>
                </div>
                <div class="terms-group">
                    <div class="term-item">
                        <div class="term-left">
                            <input type="checkbox" id="terms1" class="term-checkbox" required>
                            <label for="terms1">이용약관 동의 <span class="required">*</span></label>
                        </div>
                        <button type="button" class="view-btn" onclick="showTermsPopup('terms-of-service')">전문보기</button>
                    </div>
                    <div class="term-item">
                        <div class="term-left">
                            <input type="checkbox" id="terms2" class="term-checkbox" required>
                            <label for="terms2">개인정보 수집 및 이용 동의 <span class="required">*</span></label>
                        </div>
                        <button type="button" class="view-btn" onclick="showTermsPopup('privacy-policy')">전문보기</button>
                    </div>
                    <div class="term-item">
                        <div class="term-left">
                            <input type="checkbox" id="terms3" class="term-checkbox">
                            <label for="terms3">마케팅 정보 이용 및 수신동의 <span class="optional">(선택)</span></label>
                        </div>
                        <button type="button" class="view-btn" onclick="showTermsPopup('marketing-agreement')">전문보기</button>
                    </div>
                </div>

                <button type="submit" class="submit-btn">회원가입</button>
            </form>
            <div id="error-message" class="error-message"></div>
        </div>
    </div>

    <!-- 약관 모달 -->
    <div id="termsModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeTermsModal()">&times;</span>
            <iframe id="termsFrame" src="" frameborder="0"></iframe>
        </div>
    </div>

    <script type="module" src="/js/firebase-config.js"></script>
    <script type="module" src="/auth/js/register-business.js"></script>
    <script>
        // 뒤로가기 버튼 기능
        document.querySelector('.back-button').addEventListener('click', function() {
            history.back();
        });

        function togglePassword() {
            const passwordInput = document.getElementById('password');
            const confirmPasswordInput = document.getElementById('confirmPassword');
            const eyeIcon = document.querySelector('.eye-icon');
            const eyeOffIcon = document.querySelector('.eye-off-icon');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                confirmPasswordInput.type = 'text';
                eyeIcon.style.display = 'none';
                eyeOffIcon.style.display = 'block';
            } else {
                passwordInput.type = 'password';
                confirmPasswordInput.type = 'password';
                eyeIcon.style.display = 'block';
                eyeOffIcon.style.display = 'none';
            }
        }

        function showTermsPopup(termsType) {
            const modal = document.getElementById('termsModal');
            const frame = document.getElementById('termsFrame');
            frame.src = `/terms/${termsType}.html`;
            modal.style.display = 'block';
        }

        function closeTermsModal() {
            const modal = document.getElementById('termsModal');
            const frame = document.getElementById('termsFrame');
            modal.style.display = 'none';
            frame.src = '';
        }

        // 모달 외부 클릭 시 닫기
        window.onclick = function(event) {
            const modal = document.getElementById('termsModal');
            if (event.target == modal) {
                closeTermsModal();
            }
        }

        function toggleAllCheckboxes() {
            const allAgree = document.getElementById('allAgree');
            const checkboxes = document.querySelectorAll('.term-checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.checked = allAgree.checked;
            });
        }

        // 개별 체크박스 상태 변경시 전체동의 체크박스 업데이트
        document.addEventListener('DOMContentLoaded', function() {
            const termCheckboxes = document.querySelectorAll('.term-checkbox');
            const allAgreeCheckbox = document.getElementById('allAgree');
            
            termCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const allChecked = Array.from(termCheckboxes).every(cb => cb.checked);
                    allAgreeCheckbox.checked = allChecked;
                });
            });
        });
    </script>
</body>
</html>